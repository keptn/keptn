## @section Global values
global:
  keptn:
    ## @param global.keptn.registry Global Docker image registry
    registry: docker.io/keptn
    ## @param global.keptn.tag The tag of Keptn that should be used for all images
    tag: ""

## @section MongoDB
mongo:
  ## @param mongo.enabled
  enabled: true
  ## @param mongo.host
  host: mongodb:27017
  ## @param mongo.architecture
  architecture: standalone
  service:
    ## @param mongo.service.nameOverride
    nameOverride: 'mongo'
    ## @param mongo.service.port
    port: 27017
  auth:
    ## @param mongo.auth.enabled
    enabled: true
    ## @param mongo.auth.databases
    databases:
      - 'keptn'
    ## @param mongo.auth.existingSecret
    existingSecret: 'mongodb-credentials' # If the password and rootPassword values below are used, remove this field.
    ## @param mongo.auth.usernames
    usernames:
      - 'keptn'
    ## @param mongo.auth.password
    password: null
    ## @param mongo.auth.rootUser
    rootUser: 'admin'
    ## @param mongo.auth.rootPassword
    rootPassword: null
    ## @param mongo.auth.bridgeAuthDatabase
    bridgeAuthDatabase: 'keptn'
  external:
    ## @param mongo.external.connectionString
    connectionString:
  ## @extra mongo.containerSecurityContext Container Security Context that should be used for all MongoDB pods
  ## @skip mongo.containerSecurityContext.allowPrivilegeEscalation
  ## @skip mongo.containerSecurityContext.capabilities
  ## @skip mongo.containerSecurityContext.capabilities.drop
  containerSecurityContext:
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL
  serviceAccount:
    ## @param mongo.serviceAccount.automountServiceAccountToken
    automountServiceAccountToken: false
  ## @extra mongo.resources Define resources for MongoDB
  ## @skip mongo.resources.requests
  ## @skip mongo.resources.limits
  resources:
    requests:
      cpu: 200m
      memory: 100Mi
    limits:
      cpu: 1000m
      memory: 500Mi

## @section Keptn Features
features:
  automaticProvisioning:
    ## @param features.automaticProvisioning.serviceURL
    serviceURL: ""
    ## @param features.automaticProvisioning.message
    message: ""
  swagger:
    ## @param features.swagger.hideDeprecated
    hideDeprecated: false
  oauth:
    ## @param features.oauth.enabled Enable OAuth for Keptn
    enabled: false
    ## @param features.oauth.prefix
    prefix: "keptn:"
  git:
    ## @param features.git.remoteURLDenyList
    remoteURLDenyList: ""

## @section NATS
nats:
  ## @param nats.nameOverride
  nameOverride: keptn-nats
  ## @param nats.fullnameOverride
  fullnameOverride: keptn-nats
  cluster:
    ## @param nats.cluster.enabled Enable NATS clustering
    enabled: false
    ## @param nats.cluster.replicas Define the NATS cluster size
    replicas: 3
    ## @param nats.cluster.name Define the NATS cluster name
    name: nats
  ## @extra nats.securityContext Define security context settings for NATS
  ## @skip nats.securityContext.runAsNonRoot
  ## @skip nats.securityContext.runAsUser
  ## @skip nats.securityContext.fsGroup
  securityContext:
    runAsNonRoot: true
    runAsUser: 10001
    fsGroup: 10001
  nats:
    ## @param nats.nats.automountServiceAccountToken
    automountServiceAccountToken: false
    ## @extra nats.nats.resources Define resources for NATS
    ## @skip nats.nats.resources.requests
    ## @skip nats.nats.resources.limits
    resources:
      requests:
        cpu: 200m
        memory: 500Mi
      limits:
        cpu: 500m
        memory: 1Gi
    healthcheck:
      startup:
        ## @param nats.nats.healthcheck.startup.enabled Enable NATS startup probe
        ## ref: https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#define-startup-probes
        enabled: false
    jetstream:
      ## @param nats.nats.jetstream.enabled
      enabled: true

      ## @param nats.nats.jetstream.memStorage.enabled Enable memory storage for NATS Jetstream
      ## @param nats.nats.jetstream.memStorage.size Define the memory storage size for NATS Jetstream
      memStorage:
        enabled: true
        size: 500Mi

      ## @param nats.nats.jetstream.fileStorage.enabled
      ## @param nats.nats.jetstream.fileStorage.size
      ## @param nats.nats.jetstream.fileStorage.storageDirectory
      ## @param nats.nats.jetstream.fileStorage.storageClassName
      fileStorage:
        enabled: true
        size: 5Gi
        storageDirectory: /data/
        storageClassName: ""
    ## @extra nats.nats.securityContext Define the container security context for NATS
    ## @skip nats.nats.securityContext.readOnlyRootFilesystem
    ## @skip nats.nats.securityContext.allowPrivilegeEscalation
    ## @skip nats.nats.securityContext.privileged
    ## @skip nats.nats.securityContext.runAsNonRoot
    ## @skip nats.nats.securityContext.runAsUser
    ## @skip nats.nats.securityContext.capabilities
    ## @skip nats.nats.securityContext.capabilities.drop
    securityContext:
      readOnlyRootFilesystem: true
      allowPrivilegeEscalation: false
      privileged: false
      runAsNonRoot: true
      runAsUser: 65532
      capabilities:
        drop:
          - ALL

  natsbox:
    ## @param nats.natsbox.enabled Enable NATS Box utility container
    enabled: false
  reloader:
    ## @param nats.reloader.enabled Enable NATS Config Reloader sidecar to reload configuration during runtime
    enabled: false
  exporter:
    ## @param nats.exporter.enabled Enable NATS Prometheus Exporter sidecar to emit prometheus metrics
    enabled: false

## @section API Gateway NginX
apiGatewayNginx:
  ## @param apiGatewayNginx.type
  type: ClusterIP
  ## @param apiGatewayNginx.port
  port: 80
  ## @param apiGatewayNginx.targetPort
  targetPort: 8080
  ## @param apiGatewayNginx.nodePort
  nodePort: 31090
  podSecurityContext:
    ## @param apiGatewayNginx.podSecurityContext.enabled Enable the pod security context for the API Gateway
    enabled: true
    ## @param apiGatewayNginx.podSecurityContext.defaultSeccompProfile Use the default seccomp profile for the API Gateway
    defaultSeccompProfile: true
    ## @param apiGatewayNginx.podSecurityContext.fsGroup Filesystem group to be used by the API Gateway
    fsGroup: 101
  ## @extra apiGatewayNginx.containerSecurityContext Define a container security context for the API Gateway
  ## @skip apiGatewayNginx.containerSecurityContext.enabled
  ## @skip apiGatewayNginx.containerSecurityContext.runAsNonRoot
  ## @skip apiGatewayNginx.containerSecurityContext.runAsUser
  ## @skip apiGatewayNginx.containerSecurityContext.readOnlyRootFilesystem
  ## @skip apiGatewayNginx.containerSecurityContext.allowPrivilegeEscalation
  ## @skip apiGatewayNginx.containerSecurityContext.privileged
  ## @skip apiGatewayNginx.containerSecurityContext.capabilities
  ## @skip apiGatewayNginx.containerSecurityContext.capabilities.drop
  containerSecurityContext:
    enabled: true
    runAsNonRoot: true
    runAsUser: 101
    readOnlyRootFilesystem: false
    allowPrivilegeEscalation: false
    privileged: false
    capabilities:
      drop:
        - ALL
  image:
    ## @param apiGatewayNginx.image.registry API Gateway image registry
    registry: "docker.io/nginxinc"
    ## @param apiGatewayNginx.image.repository API Gateway image repository
    repository: "nginx-unprivileged"
    ## @param apiGatewayNginx.image.tag API Gateway image tag
    tag: "1.22.0-alpine"
  ## @param apiGatewayNginx.nodeSelector
  nodeSelector: {}
  ## @param apiGatewayNginx.gracePeriod
  gracePeriod: 60
  ## @param apiGatewayNginx.preStopHookTime
  preStopHookTime: 20
  ## @param apiGatewayNginx.clientMaxBodySize
  clientMaxBodySize: "5m"
  ## @param apiGatewayNginx.sidecars Add additional sidecar containers to the API Gateway
  sidecars: []
  ## @param apiGatewayNginx.extraVolumeMounts Add additional volume mounts to the API Gateway
  extraVolumeMounts: []
  ## @param apiGatewayNginx.extraVolumes Add additional volumes to the API Gateway
  extraVolumes: []
  ## @extra apiGatewayNginx.resources Define resources for the API Gateway
  ## @skip apiGatewayNginx.resources.requests
  ## @skip apiGatewayNginx.resources.limits
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "128Mi"
      cpu: "100m"

remediationService:
  enabled: true
  image:
    ## @param remediationService.image.registry Remediation Service image registry
    registry: ""
    ## @param remediationService.image.repository Remediation Service image repository
    repository: "remediation-service"
    ## @param remediationService.image.tag Remediation Service image tag
    tag: ""
  nodeSelector: {}
  gracePeriod: 60
  preStopHookTime: 5
  ## @param remediationService.sidecars Add additional sidecar containers to the Remediation Service
  sidecars: []
  ## @param remediationService.extraVolumeMounts Add additional volume mounts to the Remediation Service
  extraVolumeMounts: []
  ## @param remediationService.extraVolumes Add additional volumes to the Remediation Service
  extraVolumes: []
  ## @extra remediationService.resources Define resources for the Remediation Service
  ## @skip remediationService.resources.requests
  ## @skip remediationService.resources.limits
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "1Gi"
      cpu: "200m"

apiService:
  tokenSecretName:
  image:
    ## @param apiService.image.registry API Service image registry
    registry: ""
    ## @param apiService.image.repository API Service image repository
    repository: "api"    
    ## @param apiService.image.tag API Service image tag
    tag: ""
  maxAuth:
    enabled: true
    requestsPerSecond: "1.0"
    requestBurst: "2"
  nodeSelector: {}
  gracePeriod: 60
  preStopHookTime: 5
  ## @param apiService.sidecars Add additional sidecar containers to the API Service
  sidecars: []
  ## @param apiService.extraVolumeMounts Add additional volume mounts to the API Service
  extraVolumeMounts: []
  ## @param apiService.extraVolumes Add additional volumes to the API Service
  extraVolumes: []
  ## @extra apiService.resources Define resources for the API Service
  ## @skip apiService.resources.requests
  ## @skip apiService.resources.limits
  resources:
    requests:
      memory: "32Mi"
      cpu: "50m"
    limits:
      memory: "64Mi"
      cpu: "100m"

bridge:
  image:
    ## @param bridge.image.registry Bridge image registry
    registry: ""
    ## @param bridge.image.repository Bridge image repository
    repository: "bridge2"
    ## @param bridge.image.tag Bridge image tag
    tag: ""
  cliDownloadLink: null
  secret:
    enabled: true
  versionCheck:
    enabled: true
  showApiToken:
    enabled: true
  installationType: null
  lookAndFeelUrl: null
  podSecurityContext:
    enabled: true
    defaultSeccompProfile: true
    fsGroup: 65532
  containerSecurityContext:
    enabled: true
    runAsNonRoot: true
    runAsUser: 65532
    readOnlyRootFilesystem: true
    allowPrivilegeEscalation: false
    privileged: false
    capabilities:
      drop:
        - ALL
  oauth:
    discovery: ""
    secureCookie: false
    trustProxy: ""
    sessionTimeoutMin: ""
    sessionValidatingTimeoutMin: ""
    baseUrl: ""
    clientID: ""
    clientSecret: ""
    IDTokenAlg: ""
    scope: ""
    userIdentifier: ""
    mongoConnectionString: ""
  authMsg: ""
  d3:
    enabled: true
  nodeSelector: {}
  ## @param bridge.sidecars Add additional sidecar containers to the Bridge
  sidecars: []
  ## @param bridge.extraVolumeMounts Add additional volume mounts to the Bridge
  extraVolumeMounts: []
  ## @param bridge.extraVolumes Add additional volumes to the Bridge
  extraVolumes: []
  ## @extra bridge.resources Define resources for the Bridge
  ## @skip bridge.resources.requests
  ## @skip bridge.resources.limits
  resources:
    requests:
      memory: "64Mi"
      cpu: "25m"
    limits:
      memory: "256Mi"
      cpu: "200m"

distributor:
  metadata:
    hostname:
    namespace:
  image:
    ## @param distributor.image.registry Distributor image registry
    registry: ""
    ## @param distributor.image.repository Distributor image repository
    repository: "distributor"
    ## @param distributor.image.tag Distributor image tag
    tag: ""
  config:
    proxy:
      httpTimeout: "30"
      maxPayloadBytesKB: "64"
    queueGroup:
      enabled: true
    oauth:
      clientID: ""
      clientSecret: ""
      discovery: ""
      tokenURL: ""
      scopes: ""
  ## @extra distributor.resources Define resources for the Distributor
  ## @skip distributor.resources.requests
  ## @skip distributor.resources.limits
  resources:
    requests:
      memory: "16Mi"
      cpu: "25m"
    limits:
      memory: "32Mi"
      cpu: "100m"

shipyardController:
  image:
    ## @param shipyardController.image.registry Shipyard Controller image registry
    registry: ""
    ## @param shipyardController.image.repository Shipyard Controller image repository
    repository: "shipyard-controller"
    ## @param shipyardController.image.tag Shipyard Controller image tag
    tag: ""
  config:
    taskStartedWaitDuration: "10m"
    uniformIntegrationTTL: "48h"
    leaderElection:
      enabled: false
    replicas: 1
    validation:
      # On Database level, Keptn creates collections that are named like <PROJECTNAME>-<suffix>
      # Keep in mind that "suffix" can occupy up to 20 characters so that you will eventually
      # hit the database limit for max collection name size when your project name is too long.
      # projectNameMaxSize can be used to forbid project names longer than a certain size in Keptn
      projectNameMaxSize: 200
      # The limit of 43 characters for a service's name is currently imposed by the helm-service,
      # which, if being used for the CD use case with blue/green deployments generates a helm release called <serviceName>-generated,
      # and helm releases have a maximum length of 53 characters. Therefore, we use this value as a default.
      # If the helm chart generation for blue/green deployments is not needed, and this value is too small, it can be adapted here
      serviceNameMaxSize: 43
  nodeSelector: {}
  gracePeriod: 60
  preStopHookTime: 15
  ## @param shipyardController.sidecars Add additional sidecar containers to Shipyard Controller
  sidecars: []
  ## @param shipyardController.extraVolumeMounts Add additional volume mounts to Shipyard Controller
  extraVolumeMounts: []
  ## @param shipyardController.extraVolumes Add additional volumes to Shipyard Controller
  extraVolumes: []
  ## @extra shipyardController.resources Define resources for Shipyard Controller
  ## @skip shipyardController.resources.requests
  ## @skip shipyardController.resources.limits
  resources:
    requests:
      memory: "32Mi"
      cpu: "50m"
    limits:
      memory: "128Mi"
      cpu: "100m"

secretService:
  image:
    ## @param secretService.image.registry Secret Service image registry
    registry: ""
    ## @param secretService.image.repository Secret Service image repository
    repository: "secret-service"     
    ## @param secretService.image.tag Secret Service image tag
    tag: ""
  nodeSelector: {}
  gracePeriod: 60
  preStopHookTime: 20
  ## @param secretService.sidecars Add additional sidecar containers to the Secret Service
  sidecars: []
  ## @param secretService.extraVolumeMounts Add additional volume mounts to the Secret Service
  extraVolumeMounts: []
  ## @param secretService.extraVolumes Add additional volumes to the Secret Service
  extraVolumes: []
  ## @extra secretService.resources Define resources for the Secret Service
  ## @skip secretService.resources.requests
  ## @skip secretService.resources.limits
  resources:
    requests:
      memory: "32Mi"
      cpu: "25m"
    limits:
      memory: "64Mi"
      cpu: "200m"

resourceService:
  replicas: 1
  image:
    ## @param resourceService.image.registry Resource Service image registry
    registry: ""
    ## @param resourceService.image.repository Resource Service image repository
    repository: "resource-service"   
    ## @param resourceService.image.tag Resource Service image tag
    tag: ""
  env:
    GIT_KEPTN_USER: "keptn"
    GIT_KEPTN_EMAIL: "keptn@keptn.sh"
    DIRECTORY_STAGE_STRUCTURE: "false"
  nodeSelector: {}
  gracePeriod: 60
  fsGroup: 1001
  preStopHookTime: 20
  ## @param resourceService.sidecars Add additional sidecar containers to the Resource Service
  sidecars: []
  ## @param resourceService.extraVolumeMounts Add additional volume mounts to the Resource Service
  extraVolumeMounts: []
  ## @param resourceService.extraVolumes Add additional volumes to the Resource Service
  extraVolumes: []
  ## @extra resourceService.resources Define resources for the Resource Service
  ## @skip resourceService.resources.requests
  ## @skip resourceService.resources.limits
  resources:
    requests:
      memory: "32Mi"
      cpu: "25m"
    limits:
      memory: "64Mi"
      cpu: "100m"

mongodbDatastore:
  image:
    ## @param mongodbDatastore.image.registry MongoDB Datastore image registry
    registry: ""
    ## @param mongodbDatastore.image.repository MongoDB Datastore image repository
    repository: "mongodb-datastore"  
    ## @param mongodbDatastore.image.tag MongoDB Datastore image tag
    tag: ""
  nodeSelector: {}
  gracePeriod: 60
  preStopHookTime: 20
  ## @param mongodbDatastore.sidecars Add additional sidecar containers to the MongoDB Datastore
  sidecars: []
  ## @param mongodbDatastore.extraVolumeMounts Add additional volume mounts to the MongoDB Datastore
  extraVolumeMounts: []
  ## @param mongodbDatastore.extraVolumes Add additional volumes to the MongoDB Datastore
  extraVolumes: []
  ## @extra mongodbDatastore.resources Define resources for the MongoDB Datastore
  ## @skip mongodbDatastore.resources.requests
  ## @skip mongodbDatastore.resources.limits
  resources:
    requests:
      memory: "32Mi"
      cpu: "50m"
    limits:
      memory: "512Mi"
      cpu: "300m"

lighthouseService:
  enabled: true
  image:
    ## @param lighthouseService.image.registry Lighthouse Service image registry
    registry: ""
    ## @param lighthouseService.image.repository Lighthouse Service image repository
    repository: "lighthouse-service" 
    ## @param lighthouseService.image.tag Lighthouse Service image tag
    tag: ""
  nodeSelector: {}
  gracePeriod: 60
  preStopHookTime: 20
  ## @param lighthouseService.sidecars Add additional sidecar containers to the Lighthouse Service
  sidecars: []
  ## @param lighthouseService.extraVolumeMounts Add additional volume mounts to the Lighthouse Service
  extraVolumeMounts: []
  ## @param lighthouseService.extraVolumes Add additional volumes to the Lighthouse Service
  extraVolumes: []
  ## @extra lighthouseService.resources Define resources for the Lighthouse Service
  ## @skip lighthouseService.resources.requests
  ## @skip lighthouseService.resources.limits
  resources:
    requests:
      memory: "128Mi"
      cpu: "50m"
    limits:
      memory: "1Gi"
      cpu: "200m"

statisticsService:
  enabled: true
  image:
    ## @param statisticsService.image.registry Statistics Service image registry
    registry: ""
    ## @param statisticsService.image.repository Statistics Service image repository
    repository: "statistics-service" 
    ## @param statisticsService.image.tag Statistics Service image tag
    tag: ""
  nodeSelector: {}
  gracePeriod: 60
  preStopHookTime: 20
  ## @param statisticsService.sidecars Add additional sidecar containers to the Statistics Service
  sidecars: []
  ## @param statisticsService.extraVolumeMounts Add additional volume mounts to the Statistics Service
  extraVolumeMounts: []
  ## @param statisticsService.extraVolumes Add additional volumes to the Statistics Service
  extraVolumes: []
  ## @extra statisticsService.resources Define resources for the Statistics Service
  ## @skip statisticsService.resources.requests
  ## @skip statisticsService.resources.limits
  resources:
    requests:
      memory: "32Mi"
      cpu: "25m"
    limits:
      memory: "64Mi"
      cpu: "100m"

approvalService:
  enabled: true
  image:
    ## @param approvalService.image.registry Approval Service image registry
    registry: ""
    ## @param approvalService.image.repository Approval Service image repository
    repository: "approval-service"   
    ## @param approvalService.image.tag Approval Service image tag
    tag: ""
  nodeSelector: {}
  gracePeriod: 60
  preStopHookTime: 5
  ## @param approvalService.sidecars Add additional sidecar containers to the Approval Service
  sidecars: []
  ## @param approvalService.extraVolumeMounts Add additional volume mounts to the Approval Service
  extraVolumeMounts: []
  ## @param approvalService.extraVolumes Add additional volumes to the Approval Service
  extraVolumes: []
  ## @extra approvalService.resources Define resources for the Approval Service
  ## @skip approvalService.resources.requests
  ## @skip approvalService.resources.limits
  resources:
    requests:
      memory: "32Mi"
      cpu: "25m"
    limits:
      memory: "128Mi"
      cpu: "100m"

webhookService:
  enabled: true
  image:
    ## @param webhookService.image.registry Webhook Service image registry
    registry: ""
    ## @param webhookService.image.repository Webhook Service image repository
    repository: "webhook-service"    
    ## @param webhookService.image.tag Webhook Service image tag
    tag: ""
  nodeSelector: {}
  gracePeriod: 60
  preStopHookTime: 20
  ## @param webhookService.sidecars Add additional sidecar containers to the Webhook Service
  sidecars: []
  ## @param webhookService.extraVolumeMounts Add additional volume mounts to the Webhook Service
  extraVolumeMounts: []
  ## @param webhookService.extraVolumes Add additional volumes to the Webhook Service
  extraVolumes: []
  ## @extra webhookService.resources Define resources for the Webhook Service
  ## @skip webhookService.resources.requests
  ## @skip webhookService.resources.limits
  resources:
    requests:
      memory: "32Mi"
      cpu: "25m"
    limits:
      memory: "64Mi"
      cpu: "100m"

## @section Ingress
ingress:
  enabled: false
  annotations: {}
  host: {}
  path: /
  pathType: Prefix
  className: ""
  tls:
    []

## @section Common settings
logLevel: "info"

## @param prefixPath
prefixPath: ""

## @param keptnSpecVersion
keptnSpecVersion: latest

strategy:
  type: RollingUpdate
  rollingUpdate:
    maxSurge: 1
    maxUnavailable: 0
podSecurityContext:
  enabled: true
  defaultSeccompProfile: true
  fsGroup: 65532
containerSecurityContext:
  enabled: true
  runAsNonRoot: true
  runAsUser: 65532
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false
  privileged: false
  capabilities:
    drop:
      - ALL
nodeSelector: {}
