<div *ngIf="serviceName" fxFlexFill class="container">
  <div fxLayout="column" fxFlexFill fxLayoutAlign="space-between" class="pb-3">
    <div>
      <h2>Edit service: {{serviceName}}</h2>
      <ng-container *ngIf="project$ | async as project">
        <div class="settings-section">
          <h3>Configuration files</h3>
          <ng-container *ngIf="!project.gitRemoteURI">
            <span>
              There is no Git upstream repository set.<br/>To show and manage the configuration files related to the {{serviceName}} service,
            </span>
            <a [routerLink]="['/', 'project', project.projectName, 'settings', 'project']">set a Git upstream repository</a>.
          </ng-container>

          <ng-container *ngIf="fileTree && fileTree.length > 0">
            <ng-container *ngFor="let entry of fileTree">
              <div class="mt-3 mb-2">
                <div class="bold">{{entry.stage}}</div>
                Add, edit and delete files in your Git repository
                <a [href]="getLinkForStage(project.gitRemoteURI, entry.stage)" target="_blank">
                  <button dt-icon-button variant="nested" aria-label="Open git repository for stage">
                    <dt-icon name="externallink"></dt-icon>
                  </button>
                </a>
              </div>

              <ng-container *ngFor="let fileEntry of entry.files">
                <dt-expandable-section class="m-0" *ngIf="fileEntry.folder !== ''">
                  <dt-expandable-section-header class="m-0">{{fileEntry.folder}}</dt-expandable-section-header>
                  <div class="mt-2 mb-2" *ngFor="let file of fileEntry.files">{{file}}</div>
                </dt-expandable-section>
                <ng-container *ngIf="fileEntry.folder === ''">
                  <div *ngFor="let file of fileEntry.files">{{file}}</div>
                </ng-container>
              </ng-container>
            </ng-container>
          </ng-container>
          <dt-loading-spinner *ngIf="!fileTree"></dt-loading-spinner>
        </div>
      </ng-container>
    </div>
    <div class="settings-section">
      <ktb-danger-zone [data]=" getServiceDeletionData(serviceName)
    "></ktb-danger-zone>
    </div>
  </div>
</div>
