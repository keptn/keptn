<div class="container" fxFlexFill>
  <ng-container *ngIf="project$ | async as project; else loading">
    <ktb-stage-overview
      fxFlex="70"
      [project]="project"
      [selectedStageInfo]="selectedStageInfo"
      (selectedStageInfoChange)="setSelectedStageInfo(project.projectName, $event)"
      (filteredServicesChange)="stageDetails.filteredServices = $event"
      [isTriggerSequenceOpen]="!!(isTriggerSequenceOpen$ | async)"
    ></ktb-stage-overview>
    <ktb-stage-details
      fxFlex="30"
      #stageDetails
      [isQualityGatesOnly]="!!(isQualityGatesOnly$ | async)"
      [project]="project"
      [selectedStageInfo]="selectedStageInfo"
      (selectedStageInfoChange)="setSelectedStageInfo(project.projectName, $event)"
    ></ktb-stage-details>
  </ng-container>
</div>
<ng-template #loading>
  <div fxFlexFill fxLayout="row" fxLayoutAlign="center center" uitestid="ktb-environment-is-loading">
    <ktb-loading-distractor>Loading â€¦</ktb-loading-distractor>
  </div>
</ng-template>
